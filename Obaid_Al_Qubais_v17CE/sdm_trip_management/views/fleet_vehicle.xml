<odoo>
    <record id="action_trip_vehicle_view" model="ir.actions.act_window">
        <field name="name">Vehicle Trips</field>
        <field name="res_model">trip.management</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{}</field>
        <field name="domain">[('plate_id', '=', active_id)]</field>
    </record>
    <record id="view_fleet_vehicle_form_inherit" model="ir.ui.view">
        <field name="name">fleet.vehicle.form.inherit.license</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='button_box']/button[field[@name='odometer_count']]" position="after">
                <button name="%(action_trip_vehicle_view)d"
                        type="action"
                        class="oe_stat_button"
                        icon="fa-road"
                        context="{'search_default_plate_id': active_id}">
                    <field name="trip_count" widget="statinfo" string="Trips"/>
                </button>
            </xpath>
            <field name="license_plate" position="replace">
                    <field name="license_plate" class="oe_inline" placeholder="e.g. PAE 326" required="1"/>
                </field>
            <field name="driver_id" position="replace"/>
            <field name="location" position="after">
                <field name="required_license_type"/>
                <field name="license_expiration_date" invisible="1"/>
                <field name="project_id" invisible="1"/>
                <!--                <field name="monthly_cost" invisible="1"/>-->
            </field>
            <field name="mobility_card" position="before">
                <field name="employee_driver_id"
                       string="Driver (Employee)"
                       readonly="1"
                       context="{'form_view_ref': 'hr.view_employee_form'}"/>
            </field>
        </field>
    </record>
    <record id="view_fleet_service_part_line_search" model="ir.ui.view">
        <field name="name">fleet.vehicle.service.part.line.search</field>
        <field name="model">fleet.vehicle.service.part.line</field>
        <field name="arch" type="xml">
            <search string="Search Spare Parts Usage">
                <field name="vehicle_id" string="Vehicle"/>
                <field name="used_date" string="Used Date"/>
                <field name="product_id"/>
                <field name="vendor_id"/>
                <field name="usage_type"/>
                <filter name="filter_today" string="Today" domain="[('used_date', '>=', context_today())]"/>
                <filter name="filter_this_week" string="This Week"
                        domain="[('used_date', '>=', (context_today() - datetime.timedelta(days=context_today().weekday())))]"/>
                <filter name="filter_this_month" string="This Month"
                        domain="[('used_date', '>=', (context_today().replace(day=1)))]"/>
                <group expand="0" string="Group By">
                    <filter name="group_by_vehicle" string="Vehicle" context="{'group_by': 'vehicle_id'}"/>
                    <filter name="group_by_date" string="Used Date" context="{'group_by': 'used_date'}"/>
                    <filter name="group_by_month" string="Month" context="{'group_by': 'used_date:month'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="fleet_vehicle_log_services_form_inherit_garage" model="ir.ui.view">
        <field name="name">fleet.vehicle.log.services.form.inherit.garage</field>
        <field name="model">fleet.vehicle.log.services</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_log_services_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <button name="action_create_accounting_invoice"
                        type="object"
                        string="Create Invoice"
                        class="btn-primary"
                        invisible="service_status != 'completed'"/>
                <button name="action_mark_completed"
                        string="Mark as Completed"
                        type="object"
                        class="btn-primary"
                        invisible="hide_mark_button"/>
            </xpath>
            <xpath expr="//group[@col='2']/group[1]/field[@name='description']" position="replace"/>
            <xpath expr="//form/sheet/group" position="after">
                <group string="Service Tracking">
                    <field name="description"/>
                    <field name="in_timestamp"/>
                    <field name="out_timestamp"/>
                    <field name="wrench_time" readonly="1"/>
                    <field name="service_status"/>
                    <field name="hide_mark_button" invisible="1"/>
                </group>
                <group string="Consumables / Parts">
                    <field name="consumable_line_ids">
                        <tree editable="bottom">
                            <field name="product_id"/>
                            <field name="quantity"/>
                            <field name="usage_type"/>
                            <field name="used_date"/>
                            <field name="usage_reason"/>
                            <field name="vendor_id"/>
                        </tree>
                    </field>
                </group>
                <group string="SAP / Accounting Info">
                    <field name="is_inhouse" readonly="1"/>
                    <field name="sap_cost_fetched"/>
                    <field name="sap_cost_total"/>
                    <field name="accounting_entry_created" readonly="1"/>
                    <field name="invoice_id" readonly="1"/>
                    <field name="invoice_number" readonly="1"/>
                </group>
            </xpath>
        </field>
    </record>
    <record id="view_fleet_vehicle_form_inherit_cicpa" model="ir.ui.view">
        <field name="name">fleet.vehicle.form.inherit.cicpa</field>
        <field name="model">fleet.vehicle</field>
        <field name="inherit_id" ref="fleet.fleet_vehicle_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet/notebook" position="inside">
                <page string="CICPA">
                    <group colspan="2">
                        <group string="CICPA">
                            <field name="certification"/>
                            <field name="reference_number"/>
                            <field name="cicpa_expiry_date"/>
                            <field name="cicpa_location"/>
                        </group>
                        <group>
                            <separator string="CICPA Certificate" colspan="2"/>
                            <field name="cicpa_document_1" filename="CICPA Document 1"/>
                            <field name="cicpa_document_2" filename="CICPA Document 2"/>
                            <field name="cicpa_document_3" filename="CICPA Document 3"/>
                            <field name="cicpa_document_4" filename="CICPA Document 4"/>
                        </group>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
    <record id="view_fleet_service_part_line_tree" model="ir.ui.view">
        <field name="name">fleet.vehicle.service.part.line.tree</field>
        <field name="model">fleet.vehicle.service.part.line</field>
        <field name="arch" type="xml">
            <tree>
                <field name="vehicle_id"/>
                <field name="product_id"/>
                <field name="quantity"/>
                <field name="usage_type"/>
                <field name="used_date"/>
                <field name="vendor_id"/>
                <field name="usage_reason"/>
            </tree>
        </field>
    </record>
    <record id="view_fleet_service_part_line_search" model="ir.ui.view">
        <field name="name">fleet.vehicle.service.part.line.search</field>
        <field name="model">fleet.vehicle.service.part.line</field>
        <field name="arch" type="xml">
            <search>
                <field name="vehicle_id"/>
                <field name="product_id"/>
                <field name="vendor_id"/>
                <field name="usage_type"/>
                <field name="used_date"
                       filter_domain="[(used_date,'&gt;=',context.get('date_from')), (used_date,'&lt;=',context.get('date_to'))]"/>


                <group expand="0" string="Group By">
                    <filter name="group_by_vehicle" string="Vehicle" context="{'group_by': 'vehicle_id'}"/>
                    <filter name="group_by_date" string="Date" context="{'group_by': 'used_date'}"/>
                    <filter name="group_by_month" string="Month" context="{'group_by': 'used_date:month'}"/>
                </group>
            </search>
        </field>
    </record>
    <record id="action_fleet_service_part_line" model="ir.actions.act_window">
        <field name="name">Spare Parts Usage Report</field>
        <field name="res_model">fleet.vehicle.service.part.line</field>
        <field name="view_mode">tree</field>
        <field name="search_view_id" ref="view_fleet_service_part_line_search"/>
    </record>

    <menuitem id="menu_fleet_service_part_report"
              name="Monthly Parts Usage"
              parent="fleet.fleet_vehicles"
              action="action_fleet_service_part_line"/>

</odoo>
